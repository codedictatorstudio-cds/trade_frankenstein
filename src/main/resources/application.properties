# ====================== Server ======================
server.port=8080
# Bind locally (since it's your personal bot)
server.address=127.0.0.1

# ====================== DataSource ==================
spring.datasource.url=${DB_URL:jdbc:mysql://avnadmin:AVNS_aFQZM8YgJeXy-1SN9BZ@code-dictator-studio-codedictatorstudio-7d01.i.aivencloud.com:14728/CDS?ssl-mode=REQUIRED}
spring.datasource.username=${DB_USERNAME:avnadmin}
spring.datasource.password=${DB_PASSWORD:AVNS_aFQZM8YgJeXy-1SN9BZ}

# Hikari (moved under spring.datasource.hikari.*)
spring.datasource.hikari.pool-name=tf-hikari
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=30000

# ====================== JPA =========================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.format_sql=fal


# ====================== CORS (used by CorsConfig) ===
app.ui.origin=http://localhost:5173

# ====================== Logging =====================
logging.level.root=INFO
logging.pattern.console=%d{HH:mm:ss.SSS} %-5level [%thread] %logger{36} [%X{requestId}] - %msg%n

# ====================== Springdoc / Swagger UI ======
# Swagger UI: http://localhost:8080/swagger-ui/index.html
# (These are optional; defaults are fine. Uncomment to customize paths.)
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/v3/api-docs

# ====================== Timezone (optional) =========
# If you want to force Boot to a timezone:
# spring.jackson.time-zone=Asia/Kolkata

spring.task.scheduling.pool.size=4
spring.task.scheduling.thread-name-prefix=sched-
spring.task.scheduling.shutdown.await-termination=true
spring.task.scheduling.shutdown.await-termination-period=10s

# ====================== Broker Toggles ==============
# Switch when you’re ready for real brokerage:
broker=${BROKER:mock}              # mock | upstox
trade.mode=${TRADE_MODE:sandbox}   # sandbox | live

# ====================== Upstox (OAuth & API) ========
# Keep secrets in env vars; these are only placeholders.
upstox.enabled=${UPSTOX_ENABLED:false}
upstox.client-id=${UPSTOX_CLIENT_ID:3e7d3f4e-a12b-4384-ae1f-f37a6aa73bc8}
upstox.client-secret=${UPSTOX_CLIENT_SECRET:2sue1sz85o}
upstox.access-token=${UPSTOX_ACCESS_TOKEN:eyJ0eXAiOiJKV1QiLCJrZXlfaWQiOiJza192MS4wIiwiYWxnIjoiSFMyNTYifQ.eyJzdWIiOiIzMkM1R0wiLCJqdGkiOiI2OGJjNmExNWYxMWQxNTMyNGNiYzc4YTYiLCJpc011bHRpQ2xpZW50IjpmYWxzZSwiaXNQbHVzUGxhbiI6dHJ1ZSwiaWF0IjoxNzU3MTc4Mzg5LCJpc3MiOiJ1ZGFwaS1nYXRld2F5LXNlcnZpY2UiLCJleHAiOjE3NTcxOTYwMDB9.w0of_RhxbWUVsiMI_mnL9SYyZzxgJiw362WhD1FbLhU}
upstox.redirect-uri=${UPSTOX_REDIRECT_URI:http://localhost:8080/dashboard}
upstox.scopes=${UPSTOX_SCOPES:read,trade}

# Core endpoints (override if Upstox changes URLs)
upstox.base-url=${UPSTOX_BASE_URL:https://api-v2.upstox.com}
upstox.auth-url=${UPSTOX_AUTH_URL:https://api.upstox.com/v2/login/authorization/dialog}
upstox.token-url=${UPSTOX_TOKEN_URL:https://api-v2.upstox.com/login/authorization/token}
upstox.refresh-url=${UPSTOX_REFRESH_URL:https://api-v2.upstox.com/login/refresh/token}

# Streams / websockets
upstox.websocket.market-data-url=${UPSTOX_WS_MD_URL:wss://api-v2.upstox.com/feed/market-data-feed}
upstox.websocket.order-updates-url=${UPSTOX_WS_ORDERS_URL:wss://api-v2.upstox.com/feed/portfolio-stream}

# Defaults & flags (tune to your flow)
upstox.paper-trading=${UPSTOX_PAPER_TRADING:true}
upstox.account-id=${UPSTOX_ACCOUNT_ID:}
upstox.default-exchange=${UPSTOX_DEFAULT_EXCHANGE:NSE}
upstox.default-product=${UPSTOX_DEFAULT_PRODUCT:INTRADAY}
upstox.default-validity=${UPSTOX_DEFAULT_VALIDITY:DAY}

# HTTP client timeouts (if your Upstox client reads these)
upstox.http.connect-timeout-ms=${UPSTOX_HTTP_CONNECT_TIMEOUT_MS:5000}
upstox.http.read-timeout-ms=${UPSTOX_HTTP_READ_TIMEOUT_MS:15000}
upstox.http.write-timeout-ms=${UPSTOX_HTTP_WRITE_TIMEOUT_MS:15000}

# ==== Core symbol ====
trade.symbol.nifty=NIFTY

# ==== MarketSignalsService (momentum + regime) ====
# How many recent 1-min candles to read (oldest→newest limited to this)
trade.momentum.lookback-candles=120
# Baseline window for z-score (previous returns count)
trade.momentum.window=60
# Regime classification thresholds
trade.regime.z.up=1.0
trade.regime.z.down=-1.0
trade.regime.rv.high=0.006
trade.regime.rv.low=0.002
trade.regime.atrpct.range=0.0025

# ==== Engine (scheduler + safety) ====
trade.engine.max-exec-per-tick=1
trade.engine.scan-limit=10

# ==== Strategy selection (no new classes) ====
# Choose which generator to use inside DecisionService.generateAdvice()
# SENTIMENT_ONLY or DQS (your composite)
trade.strategy.mode=SENTIMENT_ONLY
trade.strategy.sentiment.enabled=true
trade.strategy.sentiment.min-confidence=65
trade.strategy.sentiment.entry-long-score=60
trade.strategy.sentiment.entry-short-score=40
trade.strategy.sentiment.cooldown-minutes=5

# ==== News ingestion → sentiment snapshots ====
trade.news.enabled=true
trade.news.refresh-ms=60000
# Comma-separated RSS/Atom feeds (put your real feeds here)
trade.news.urls=https://economictimes.indiatimes.com/markets/rssfeeds/1977021501.cms,https://www.livemint.com/rss/markets,https://www.business-standard.com/rss-feeds/listing
# Simple keyword buckets (tweak freely)
trade.news.keywords.bullish=surge,record high,upbeat,rally,gains,rise,beat estimates,positive
trade.news.keywords.bearish=plunge,selloff,downbeat,fall,losses,decline,miss estimates,negative
trade.news.min-items-for-high-confidence=12
trade.news.max-items-per-feed=30

# ==== Upstox token refresh (already agreed) ====
trade.upstox.refresh.enabled=true
trade.upstox.refresh-ms=900000
trade.upstox.refresh-before-ms=60000

# Portfolio sync cadence
trade.portfolio.refresh-ms=60000

# (Already present but reiterating)
app.timezone=Asia/Kolkata
trade.engine.tick-ms=2000
trade.upstox.refresh.on-startup=true
trade.upstox.refresh.cron=0 20 3 * * *




